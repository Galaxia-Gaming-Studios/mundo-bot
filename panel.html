<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Bots</title>
    <link rel="stylesheet" href="estilos.css">
    <script type="module" src="config.js"></script> 
    <style>
        #chat-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s ease;
        }
        #chat-button:hover { background-color: #0056b3; }
        #chat-message {
            position: fixed;
            bottom: 90px;
            right: 30px;
            background: #ffcc00;
            color: black;
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
    </style>
</head>
<body>

    <div class="header">
        <div class="user-info">
            <h2>Bienvenido, <span id="user-name"></span></h2>
            <p>Email: <span id="user-email"></span></p>
        </div>
        <button onclick="cerrarSesion()">Cerrar sesión</button>
    </div>

    <div class="bot-container">
        <div class="bot-card">
            <img src="assets/images/bot1.png" alt="Bot 1">
            <h3>KIRITO-BOT PARA GRUPOS</h3>
            <button onclick="redireccionarPago('Bot de Grupos', 10, '50488198573')">𝗠𝗘𝗡𝗦: 10$</button>
        </div>
        <div class="bot-card">
            <img src="assets/images/bot2.jpg" alt="Bot Personal">
            <h3>KIRITO-BOT PERSONAL</h3>
            <button onclick="redireccionarPago('Bot Personal', 5, '50488198573')">𝗠𝗘𝗡𝗦: 5$</button>
        </div>
    </div>

    <div class="additional-links">
        <a href="chat.html"><button>Ir al Chat con Kirito-Bot</button></a>
        <a href="grd-img.html"><button>Generar Imágenes</button></a>
    </div>

    <a href="https://Wa.me/50488198573" target="_blank" class="btnSoporte">Contactar Soporte</a>

    <button id="estadisticas-btn" style="display: none;">Ver estadísticas</button>

    <div id="estadisticas" style="display: none;">
        <p>Visitas a la página: <span id="visitas-contador">0</span></p>
        <p>Usuarios registrados: <span id="usuarios-contador">0</span></p>
    </div>

    <div id="chat-message">Únete al chat</div>
    <button id="chat-button" onclick="window.location.href='chat-public.html'">💬</button>

    <footer>
        <p>&copy; DEYLIN® 2025</p>
    </footer>

    <script type="module">
        import config from './config.js';

        window.onload = function() {
            const usuario = JSON.parse(localStorage.getItem('user'));
            const visitas = localStorage.getItem('visitas') || 0;
            const usuariosRegistrados = localStorage.getItem('usuariosRegistrados') || 0;

            if (usuario) {
                document.getElementById('user-name').innerText = usuario.nombre;
                document.getElementById('user-email').innerText = usuario.email;

                // Verificar si el usuario es administrador
                if (config.adminEmails.includes(usuario.email)) {
                    document.getElementById("estadisticas-btn").style.display = "block";
                }

                const chatMessage = document.getElementById("chat-message");
                chatMessage.style.opacity = "1";
                setTimeout(() => { chatMessage.style.opacity = "0"; }, 5000);
            } else {
                window.location.href = "index.html";
            }

            document.getElementById("estadisticas-btn").addEventListener("click", function() {
                document.getElementById("estadisticas").style.display = "block";
                document.getElementById("visitas-contador").innerText = visitas;
                document.getElementById("usuarios-contador").innerText = usuariosRegistrados;
            });
        };

        function cerrarSesion() {
            const usuario = JSON.parse(localStorage.getItem('user'));
            if (!usuario) {
                window.location.href = "index.html";
                return;
            }
            const confirmacion = confirm(`Hola ${usuario.nombre}, ¿estás seguro de que quieres eliminar tu sesión?`);
            if (confirmacion) {
                localStorage.removeItem('user');
                window.location.href = "index.html";
            }
        }

        function redireccionarPago(tipoBot, precio, numero) {
            const mensaje = `Hola, quiero comprar el ${tipoBot} por ${precio}$.`;
            const url = `https://wa.me/${numero}?text=${encodeURIComponent(mensaje)}`;
            window.location.href = url;
        }
    </script>

</body>
</html>